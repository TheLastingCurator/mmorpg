# Дизайн документ игры The Inmost Trail

## Краткое описание игры:

"The Inmost Trail" — это мрачное приключенческое MMORPG, где игроки погружаются в мир Даркхольм, сотканный из темноты и древних мифов. В этом бескрайнем и постоянно меняющемся мире нет ни одной безопасной зоны: PvP-сражения возможны в любом месте, обещая неожиданные столкновения и непредсказуемые исходы. Игроков ждёт путешествие по бездонным пропастям, искривлённым лесам и запредельным реальностям, каждое из которых таит в себе древние тайны и могущественные артефакты.

## Основные особенности игры:

- 2.5d графика, вид и управление как в Diablo и Ultima Online.

- Мир без безопасных зон: The Inmost Trail предлагает мир, где каждый шаг может стать последним. Игрокам необходимо быть настороже: опасности поджидают везде, от древних руин до таинственных лесов.
  
- Древние мифы и космические угрозы: В игре исследуется уникальная мифология, сочетающая в себе эпических богов, культы, посвящённые древним силам, и космические сущности за пределами человеческого понимания.
  
- Глубокая система магии и артефактов: Игроки могут изучать древние заклинания и постигать магию, связанную с Триумвиратом Сил и Древними Богами, а также находить и использовать могущественные артефакты.
  
- Циклы Возрождения: Игра включает в себя концепцию циклов возрождения, позволяя игрокам исследовать свои прошлые жизни, узнавать секреты своего прошлого и использовать это знание для усиления своих нынешних способностей.
  
- PvP и PvE контент: "The Inmost Trail" предлагает разнообразные PvP и PvE активности, включая охоту на монстров, сражения со свирепыми боссами и стратегические битвы между игроками за контроль над ресурсами и территориями.
  
- Социальные аспекты и формирование сообщества: Важной частью игры является создание альянсов, гильдий и формирование сообщества игроков, совместно исследующих загадки Даркхольма и сталкивающихся с его ужасающими силами.

"The Inmost Trail" погружает игроков в мир, где каждая решённая загадка и каждый побеждённый враг приближает их к разгадке судьбы Даркхольма, но вместе с тем углубляет их связь с его тёмными тайнами.

## Intro:

По мере того как звуки неизвестной мелодии медленно заполняют темноту, экран оживает, погружая нас в безграничное звёздное небо. Мягкий, задумчивый голос начинает говорить:

*"В самом начале, когда Вселенная ещё лишь формировала свои первые дыхания, возникла магия — сила, порождённая великим хаосом, из которого и был создан мир Даркхольм и родился Триумвират Сил: Тьма, Судьба и Пустота. Они ткали ткань существования, и в этом ткацком станке оказался замешен наш мир."*

Кадры начинают меняться, как и страницы древней книги, каждая из которых погружает нас глубже в историю.

После завораживающих визуализаций огромной мощи Тьмы, таинственных путей Судьбы и бесконечных просторов Пустоты, воцаряется тишина, выдержав паузу, голос продолжает, теперь с новой глубиной:

*"За пределами этих первозданных сил, в дальних уголках космоса и времени, существуют Древние Боги. Рождённые из первичного хаоса, они не подчиняются общим законам Даркхольма и действуют на основе непостижимых намерений и целей. Эти боги создали мир, но не касаются его устройства напрямую, как Силы.*

На экране проявляются эфирные изображения богов — не похожие ни на что живое или мёртвое, они или обладают невероятной красотой и одновременно жуткой непостижимостью или ужасны и отвратительны. Они являются покровителями, но и разрушителями, ибо их мощь и цели лежат за границами моральных дилемм смертных. 

*"В отличие от баланса, созданного Триумвиратом Сил, боги вносят в мир элементы изменчивости и хаоса. Они являются источником культов и религий, предметом страха и обожания. Некоторые считают их источником абсолютного зла, другие — высшим благом, но истина, как всегда, находится где-то посредине."*

Затем начинается плавный переход от образов древних богов к первым шагам персонажа в мире Даркхольма. 

*"Так кто ты, путник, в этом бескрайнем мире? Отшельник, ищущий своего пути среди теней великих сил и богов, или исполнитель воли древних, желающий узнать секреты, за которыми они следуют? Твой путь начинается сейчас, и каждый выбор будет вести тебя всё глубже в лабиринты Даркхольма, где истины и легенды тесно переплетены."*

Как начало приключений игрока объявлено, экран плавно переходит в игровой процесс, обещая невообразимые открытия и опасности на каждом шагу.

## Краткий сюжет игры

В центре истории стоит Культ Вечной Тьмы, обладающий древними знаниями и ритуалами, нацеленными на пробуждение Старших Богов и изменение самой ткани реальности.

Культисты действуют с коварной предусмотрительностью, используя каждый символ и каждый ритуал в своих мрачных обрядах. Их действия приводят к падению метеорита, известного как Звезда Ужаса, в самом сердце Даркхольма. Этот метеорит, несущий в себе древние и мощные энергии, становится катализатором для серии событий, кардинально изменяющих мир.

Как эхо древних заклинаний разносится по миру, порталы в неизвестные и чуждые измерения начинают открываться, привлекая сущности и силы, которые должны были остаться скрытыми. Эти порталы не просто служат путями в другие миры, но и приносят новые угрозы в Даркхольм, усиливая хаос, распространяемый культистами.

Между тем, Звезда Ужаса притягивает внимание ученых и исследователей, желающих понять и возможно использовать его мощь. Но их экспедиции исчезают одна за другой, поглощенные мистическими силами метеорита и его окрестностей. Эти пропавшие экспедиции добавляют еще один слой мистики и загадок вокруг культа и их темных намерений.

По мере того как события разворачиваются, связь между действиями культистов, пробуждением Старших Богов, порталами и исчезновением экспедиций становится все более очевидной. Каждый шаг культа, каждый открытый портал и каждая новая аномалия служат частями грандиозного плана, направленного на изменение самого мира.

Игроки, погружаясь в "The Inmost Trail", становятся частью этой истории, исследуя, раскрывая тайны и сражаясь с последствиями действий культистов и пробужденных богов. Они сталкиваются с ужасами, скрытыми в тенях, и открывают для себя тайны, которые лучше было бы оставить нераскрытыми. Это путешествие, полное темноты и открытий, где каждый шаг может привести к новым ужасам или новым знаниям о мире Даркхольма и тех, кто его населяет.

## Игроки могут присоединиться к одной из трех фракций:

**Стражи Порядка:** Эта фракция является защитником мира Даркхольма. Стражи стремятся восстановить порядок и баланс, нарушенные падением метеорита. Они сосредоточены на исследовании аномалий, борьбе с чудовищами, вызванными метеоритом, и нейтрализации угроз, создаваемых культом и порталами. Игроки, выбирающие эту фракцию, могут участвовать в заданиях по борьбе с темными силами и исследовании мистических явлений.

**Культ Вечной Тьмы:** Культ видит в падении метеорита знак и шанс расширить свое влияние. Присоединившись к этой фракции, игроки исследуют древние ритуалы, участвуют в темных обрядах и могут взаимодействовать с пробужденными богами. Эта фракция предлагает более мрачный и таинственный путь, позволяя игрокам исследовать запретные знания и магию.

**Исследователи Неизведанного:** Эта группа состоит из ученых, исследователей и путешественников, заинтересованных в раскрытии тайн метеорита и его последствий для мира. Они сосредоточены на изучении аномалий, сборе артефактов и исследовании порталов. Игроки, присоединяющиеся к этой фракции, углубляются в научные аспекты мира и разгадывают его загадки.


## Классы персонажей:

1. Воины Тьмы — мастера ближнего боя, извлекающие силу из самой тьмы. Они используют свою способность манипулировать тенями, чтобы становиться невидимыми, поглощать урон, и создавать темные клинки и доспехи, увеличивающие их атакующие и защитные возможности. Воин Тьмы способен на короткое время окружать себя аурой тьмы, которая наносит урон противникам поблизости и делает его устойчивым к физическим атакам.

2. Стрелки Судьбы — это эксперты дальнего боя, которые комбинируют свои стрелковые навыки с магией Судьбы, позволяя им предвидеть движения врагов и мгновенно реагировать на изменения на поле боя. Кроме того, Стрелки Судьбы могут на короткий период времени изменять исход событий, увеличивая вероятность критического урона по врагам или уклонения от атак. Магиея Судьбы используется для исцеления союзников, а также для предсказания и изменения будущих событий.

3. Хранители Пустоты — это маги, основывающие свою силу на энергии Пустоты, позволяющей им создавать что-то из ничего, открывать порталы для быстрых перемещений и создавать мощные взрывы космической энергии. В дополнение к своим способностям контроля над магией Пустоты, они также научились мастерски использовать аспекты Пустоты для создания иллюзий и ментальных атак, дезориентируя и ослабляя волю своих врагов.
   
4. Культисты Хаоса — темные поклонники, ритуалисты, которые используют забытые заклинания и древние ритуалы для призыва существ из хаоса и влияния на окружающую реальность с помощью мистических обрядов, связанных с древними богами. Каждый Культист посвящает себя одному из древних богов, получая уникальные способности, соответствующие атрибутам и сферам влияния этих божеств. В зависимости от выбранной клятвы, Культист может стать мастером разрушения, защиты или манипуляции.

## Характеристики Персонажа:

### 1. Сила
Описывает физическую мощь и выносливость персонажа. Сила влияет на физический урон, способность носить тяжелое снаряжение и общий показатель здоровья. Персонажи с высокой Силой могут пробивать защиту врагов с более тяжелым вооружением и выдерживать сильные удары.

### 2. Ловкость
Заменяет агильность и определяет быстроту, гибкость и рефлексы персонажа. Ловкость повышает шанс уклонения от атак, точность в стрельбе из луков и арбалетов, а также улучшает мастерство в использовании легкого оружия. Важна для тех, кто полагается на скорость и манёвренность.

### 3. Концентрация
Сосредотачивается на ментальных способностях и магической сущности персонажа. Концентрация усиливает магический урон, эффективность и длительность заклинаний, а также общий пул и скорость восстановления маны. Эта характеристика также помогает в быстром изучении и применении сложных техник или магии.

### 4. Восприятие
Острота чувств, обеспечивающая интуитивное понимание окружающего мира и его обитателей. Восприятие позволяет персонажу замечать скрытые детали в окружении, успешнее взаимодействовать с другими персонажами, раскрывать тайны и налаживать связи. Эта характеристика улучшает общение, торговлю и дипломатию благодаря повышенной эмпатии и пониманию мотивов собеседника.

## Характеристики Оружия

**Базовый Урон:** Основной показатель урона, который оружие наносит.
**Бонус к Силе/Ловкости/Концентрации/Восприятию:** Дополнительные бонусы к определенным характеристикам персонажа.
**Шанс Критического Удара:** Процентная вероятность нанесения увеличенного урона.
**Специальные Эффекты:** Например, отравление, замораживание, огненный урон и т.д.

## Характеристики Доспехов

**Базовая Защита:** Основное значение защиты, снижающее входящий урон.
**Бонус к Выносливости:** Увеличивает физическую защиту и общее здоровье персонажа.
**Сопротивление Элементам:** Снижение урона от определенных типов атак (например, магического или элементального урона).
**Увеличение Скорости/Агильности:** Улучшение скорости перемещения или шанса уклонения.

## Формулы Урона

Включение в формулы урона характеристик оружия и доспехов позволяют создать глубокую и стратегическую систему сражений, где выбор снаряжения и его характеристики играют ключевую роль.

### Физический Урон
```
Физический_урон = (Базовый_урон_оружия + Бонус_урона_от_силы) × (1 + Шанс_крита_оружия) + Спецэффекты.
```

### Защита от Физического Урона
```
Защита = Базовая_защита_доспехов + Бонус_защиты_от_выносливости - Проникающий_урон_оружия_противника.
```

### Магический Урон
```
Магический_урон = (Базовый_магический_урон + Бонус_урона_от_концентрации) × (1 + Шанс_крита_заклинаний) + Спецэффекты.
```

### Защита от Магического Урона
```
Магическая_защита = Базовая_магическая_защита_доспехов + Сопротивление_элементам - 
Проникающий_магический_урон_противника.
```

### Пример

Рассмотрим пример расчета урона, когда воин А атакует воина Б мечом, а воин Б защищен доспехами. Для упрощения предположим, что у воина А нет специальных бонусов, кроме характеристик оружия и его личной силы.

Допустим, урон от меча воина А варьируется в диапазоне от 90% до 110% от расчетного урона. Используем те же базовые данные:

Базовый урон меча воина А = 15
Сила воина А = 20
Бонус урона от силы = +2 за каждую единицу силы
Базовая защита доспехов воина Б = 10
Выносливость воина Б = 15
Бонус защиты от выносливости = +1 за каждую единицу выносливости

Расчет с Учетом Разброса Урона:

Расчет Физического Урона от Воина А:
```
Физический урон = 15 + (20 × 2) = 55
```

Учет Разброса Урона:
```
Минимальный урон = 55 × 0.9 = 49.5
Максимальный урон = 55 × 1.1 = 60.5
Фактический урон выбирается случайным образом из диапазона [49.5, 60.5]
```

Расчет Защиты Воина Б:
```
Физическая защита = 10 + (15 × 1) = 25
```

Итоговый Урон, Полученный Воином Б:
```
Предположим, случайный урон составил 52.
Итоговый урон = 52 - 25 = 27
```

Таким образом, с учетом случайного разброса, итоговый урон, полученный воином Б, составит 27 единиц урона. Это добавляет элемент непредсказуемости в боевую систему, делая каждую схватку более динамичной и интересной.

## Игровые локации:

В игре "The Inmost Trail", игроки будут исследовать мрачный и полный тайн мир Даркхольма, каждый уголок которого хранит собственные загадки и опасности. Вот несколько основных локаций, которые придадут глубину и разнообразие игровому миру:

### 1. Забытые Руины

Остатки древнего города, поглощенные тьмой и временем. Лабиринты полуразрушенных зданий и подземелий скрывают в себе древние артефакты и существа, жаждущие крови. Игроки могут исследовать эти руины, чтобы раскрыть секреты прошлого или выполнить миссии, поставленные гильдией исследователей.

### 2. Леса Тьмы

Плотные, зловеще темные леса, в которых даже в полдень не пробивается свет. Считается, что в глубинах этих лесов прячутся порталы в миры Тьмы, что делает их опасным местом как для неопытных путников, так и для опытных воинов. Леса покрыты туманом загадок и происшествий, связанных с древними богами.

### 3. Город Видений

Место, населенное магами и чародеями, которые исследуют Судьбу и Время. Этот город представляет собой смесь изящной архитектуры и магических конструкций, создающих иллюзии и смещающих реальность. Здесь игроки могут изучать новые заклинания, получать задания и становиться свидетелями необычайных магических событий.

### 4. Бездна Пустоты

Открытая трещина в ткани реальности, через которую в Даркхольм просачивается Пустота. Территория вокруг Бездны изобилует аномалиями: плавающими камнями, извергающимися струями энергии и искажающимися ландшафтами. Погружение в Бездну обещает доступ к мощным артефактам, но также связано с большими рисками.

### 5. Алтарь Хаоса

Священное место, где Культисты Хаоса проводят свои мрачные ритуалы и приносят жертвы древним богам. Алтарь окружен плоской, безжизненной равниной, изуродованной магическими катастрофами. Эта локация выступает как центральная точка для исследований загадочной магии и сталкивания с последователями Хаоса.

### 6. Кристальные Пещеры

Месторождение редких и мощных кристаллов, хранящих в себе сконцентрированную магическую энергию. Эти кристаллы притягивают исследователей, магов и воров, каждый из которых имеет свои цели.

### 7. Туманный Пролив

Мрачная акватория, покрытая вечным туманом, в которой затонули сотни кораблей. Путешествие через Пролив опасно из-за постоянного тумана и внезапно возникающих штормов. Считается, что в глубинах вод обитают древние морские чудовища. Пиратские корабли и тайные контрабандистские маршруты также проходят через эти неспокойные воды.

### 8. Город Под Звездами

Старинный город, расположенный на вершине высокой горы, откуда открывается захватывающий вид на ночное небо. Становясь своего рода маяком для путешественников и астрономов, этот город известен своими обсерваториями и академиями магии, где ученые и маги изучают звезды и их значение.

### 9. Оазис Живых Вод

Укрытый сад среди пыльных пустынь, где вода обладает удивительными лечебными свойствами. Считается, что эти воды напитаны магической силой и могут восстанавливать здоровье и энергию путника. Оазис охраняется загадочными существами, не позволяющими использовать священные воды в корыстных целях.

### 10. Залы Вечности

Грандиозный комплекс подземелий и обширных залов под старым королевским замком, где ходит время иначе. Предания молвят, что в глубинах этих залов можно найти порталы в другие временные периоды и миры. Тайны и артефакты, затерянные в прошлом, открываются самым смелым исследователям.

### 11. Граница Теней

Место, где мир живых и мир мертвых сходятся, создавая портал между реальностями. Энергия Тьмы настолько сильна, что тени принимают физическую форму. Встречи с призраками и духами предков — обыденное дело для тех, кто осмеливается исследовать эту территорию.

### 12. Земли Безумия

Обширная территория, зараженная магией Хаоса, где действуют другие законы физики, а ландшафт меняется непредсказуемо. Животные и растения имеют аномальные формы, а путешествие через эти земли может привести к потере разума. Отсюда невозможно вернуться прежним.

### 13. Кладбище Забытых Кораблей

Гигантское кладбище на суше, где сконцентрированы обломки затонувших и заброшенных кораблей разных эпох. Это место притягивает охотников за сокровищами и исследователей, надеющихся найти древние реликвий


## Артефакты

В первые часы игры в "The Inmost Trail" игрокам могут попасться артефакты, которые служат введением в мир магии, борьбы и исследований Даркхольма. Вот примеры некоторых предметов:

### 1. Серебряный Компас Судьбы
Предсказывает ближайшее будущее, указывая в сторону полезных предметов или важных локаций.

### 2. Клинок Теневого Воина
Легкий меч, увеличивающий скорость атаки его владельца в ночное время.

### 3. Кристаллы Лечения Пустоты
Небольшие, утилизируемые кристаллы, моментально восстанавливающие часть здоровья.

### 4. Мантия Скрытности
Понижает шанс обнаружения врагами при носке. Действует только в тенях.

### 5. Амулет Хаотичного Огня
Позволяет выпустить в врага небольшой взрыв хаоса при активации. Имеет несколько зарядов.

### 6. Браслеты Связи
Укрепляет общение с союзниками, позволяя передавать небольшие объемы информации на расстоянии.

### 7. Перстень Эха
Открывает владельцу краткий взгляд на местоположение ближайших врагов при активации.

### 8. Легкие Сапоги Передвижения
Увеличивают скорость передвижения владельца на короткое время после активации.

### 9. Сфера Непостоянной Пустоты
При использовании создает небольшую зону нестабильности, которая может случайно телепортировать врагов внутри зоны на небольшое расстояние.

### 10. Книга Малых Иллюзий
Позволяет создать неподвижную иллюзию владельца, чтобы отвлечь врагов. Иллюзия длится несколько секунд.

Эти артефакты разработаны для введения игроков в основные механики "The Inmost Trail", подчеркивая важность разведки, тактики, и самосохранения в жестоком мире Даркхольма. Они призваны дать новичкам чувство разнообразия возможностей и помочь в адаптации к игровому процессу.

## Древние боги

**Силтар, Хранитель Бездонных Пропастей** – бог бездонных пропастей и неизведанных глубин. Монстр, вызывающий страх у всех, кто смеет бросить взгляд в его глубины.

**Ниарлекс, Сновидец Вечности и  Тысячеглазый Страж** – существо, обитающее на границе между сном и реальностью, властитель параллельных измерений, бог наблюдения и всевидения, чьи глаза всегда открыты.

**Иктариан, Владыка Заблудших Душ** – бог, охотящийся на заблудшие души и путешественников между мирами.

**Балфегор, Повелитель Порчи и Архитектор Разрушения** – бог разложения и упадка, распространяющий гниение и разрушение, разлагающий все на своем пути.

**Йог-Косс, Вечный Хранитель Тайн и Страж Мертвых Звезд** – загадочное существо, хранящее древние и забытые тайны космоса.  Древний бог, скрывающийся в темноте межзвездного пространства, обладающий непостижимой мощью.


## География мира

В мире Даркхольма всего один континент, имеющий форму искаженной звезды или кристалла, с рядом выступающих полуостровов и заливов, придающих ему угрюмый и неравномерный вид. Распределение географических особенностей следующее:


### Бездонные Пропасти
глубокие ущелья, исчезающие в тьме. Они извилисты и полны неожиданных разветвлений. Некоторые пропасти могут вести в подземные пещеры или тайные места, где скрыты древние артефакты.

Бездонные Пропасти находятся в центральной части континента, образуя сердце Даркхольма. Они простираются в виде сложной сети ущелий, их ветви разделяют континент на несколько регионов.

О погоде:
Весна и Осень: Переменчивая погода, частые туманы и дожди, иногда с грозами.
Лето: Теплое, но влажное, с редкими ливнями.
Зима: Холодно и мрачно, с редкими снегопадами.

### Искривлённые Леса 
густые, мрачные леса с деревьями, выглядящими как извращенные силуэты, искривленные неестественными углами. Туманы скрывают многие опасности, а пути кажутся меняющимися и запутанными.

Искривлённые Леса располагаются вокруг Бездонных Пропастей, как бы обрамляя их. Эти леса занимают значительную часть территории, простираясь до ближайших гор и берегов.

О погоде:
Весна: Теплая и влажная с частыми дождями.
Лето: Жаркое и влажное, с редкими, но сильными грозами.
Осень: Прохладно и туманно, дожди становятся чаще.
Зима: Холодно и сыро, с редкими снегопадами.

### Запредельные Реальности 
области, где границы между мирами становятся тоньше. Здесь могут встречаться сюрреалистические ландшафты, парящие острова, невозможные геометрические структуры, и порталы в другие измерения.

Запредельные Реальности обнаруживаются в отдаленных и изолированных точках континента, чаще всего на его окраинах или на полуостровах, где граница между мирами наиболее тонка.

Погода здесь непредсказуема и может меняться внезапно, независимо от времени года, отражая странности этих мест.

### Руины Древних Цивилизаций
остатки забытых городов и храмов, поглощенных временем и природой. Здесь игроки могут найти зацепки к древним загадкам и магическим артефактам.

Руины Древних Цивилизаций разбросаны по всему континенту, но особенно много их на юге, где когда-то процветали древние культуры.

### Мертвые Болота
обширные зоны с топким грунтом и отравленными водами. Здесь обитают странные существа, а местность скрывает ловушки и опасности.

Мертвые Болота находятся на северо-западе континента, представляя собой обширные зоны с топким грунтом и отравленными водами.

### Города-Призраки
одиноко стоящие, заброшенные поселения, где время остановилось. Они могут стать местом для PvP-сражений или исследований.

Города-Призраки разбросаны по всему континенту, часто встречаются на стыке различных географических зон.

Погода здесь может варьироваться, но чаще всего мрачная и пасмурная, создавая подходящую атмосферу для этих мест.

### Пустынные Владения
обширные, пустынные территории с редкими оазисами. Здесь могут встречаться караваны и странствующие торговцы, а также опасные существа.

Пустынные Владения занимают восточную часть континента, представляя собой обширные, жаркие территории с редкими оазисами.

О погоде:
Весна и Осень: Умеренно тепло, редкие дожди.
Лето: Жарко и сухо, песчаные бури.
Зима: Прохладно днём и очень холодно ночью.

Пустынные Владения богаты минералами и специями. 


### Замерзшие Высоты
горные хребты с суровым климатом и опасными тропами. Склоны могут скрывать замороженные руины или секретные проходы.

Замерзшие Высоты расположены на севере континента, где горные хребты поднимаются к небесам, скрывая в себе множество тайн.

О погоде:
Весна и Осень: Холодно, частые снегопады и ледяные ветры.
Лето: Прохладно, но ясно, редкие осадки.
Зима: Экстремально холодно, мощные снежные бури.

Замерзшие Высоты известны своими металлическими рудами.

### Море Тумана
загадочное море, покрытое постоянным туманом, где путешествия на кораблях становятся опасными из-за неожиданных штормов и морских чудовищ.

Море Тумана обрамляет западную сторону континента, добавляя ему мистического очарования и представляя собой опасную зону для мореплавателей.

Постоянно покрыто густым туманом, с частыми штормами и сильными ветрами, особенно опасно в осенний и зимний периоды.

### Обсидиановые Поля
земли, покрытые вулканическим стеклом и лавой, где живут огненные существа и могут быть найдены редкие минералы.

Обсидиановые Поля находятся на юго-западе, рядом с морем, где вулканическая активность создает ландшафт из остывшей лавы и обсидиана.

О погоде:
Весна и Осень: Умеренная температура, редкие дожди.
Лето: Жарко, возможны вулканические извержения.
Зима: Прохладно, редкие заморозки.

## Поселения

Современные поселения обеспечивают игрокам места для отдыха, восстановления ресурсов, общения и получения новых заданий, а также добавляют жизни и реалистичности в мрачный и таинственный мир Даркхольма. Наиболее крупные и влиятельные города являются центрами политической, экономической и культурной жизни.

### Общая характеристика

**Укрепленные Города на Перекрестках** - эти города находятся вблизи Бездонных Пропастей, на пересечении крупных торговых и стратегических путей. Они служат торговыми и социальными центрами, где игроки могут встретиться, обменяться ресурсами, получить задания.

**Пограничные Крепости** - расположены на границах Искривлённых Лесов и у подножия Замерзших Высот. Они служат защитными точками от вторжений и местом для подготовки к путешествиям в более опасные зоны.

**Тайные Селения** - спрятаны в глубинах Искривлённых Лесов и возле Мертвых Болот, они служат убежищем для отшельников, тайных культов и тех, кто ищет уединения или скрытых знаний.

**Караван-Сарай в Пустынных Владениях** - эти поселения служат убежищами и торговыми точками для путешественников и караванов, пересекающих жаркие пустыни.

**Портовые Города у Моря Тумана** - расположены вдоль западного побережья, эти города являются центрами мореплавания, торговли и рыболовства, а также точками отправления в приключения по морю. Портовые города могут объединяться для защиты торговых путей от пиратов.

Ритуалы Морского Культа в Портовых Городах: В портовых городах могут существовать культы, поклоняющиеся морским богам или духам. Обычаи могут включать морские праздники, жертвоприношения в море для обеспечения безопасного плавания и богатого улова.

**Горные Поселения в Замерзших Высотах** - эти небольшие, но укрепленные поселения служат базами для исследователей и альпинистов, а также защитой от горных чудовищ.

**Обсерватории и Магические Академии в Запредельных Реальностях** - расположены в местах, где границы между мирами наиболее тонки, они служат центрами исследований и магического обучения.

**Поселения Рудокопов на Обсидиановых Полях** - эти небольшие, но живучие поселения служат базами для тех, кто добывает редкие минералы и изучает вулканическую активность.

### Крупнейшие города

Эти города обеспечивают ключевые точки для взаимодействия игроков, развития сюжета и торговли, а также служат важными центрами власти в мире Даркхольма.

Тенебург - крупнейший город Даркхольма, расположеный в центре континента у входа в Бездонные Пропасти. Это город с мрачной архитектурой, башнями и замками. Тенебург является центром магии и учености, а также главным узлом торговых и политических маршрутов. Управляется Советом Магов, и здесь находится самая мощная Магическая Академия.

Морской Вал - крупнейший портовый город на западном побережье, стоящий на берегу Моря Тумана. Это центр морской торговли и кораблестроения. Город известен своими рыбными рынками, судостроительными верфями и школой навигации. Управление осуществляется Морским Советом, в который входят представители крупнейших торговых домов.

Сияющий Оазис - главный город в Пустынных Владениях, оазис среди бесконечных песков. Он славится своими базарами, где можно найти экзотические товары со всего мира. Город является центром для караванщиков и путешественников, управляется Мудрыми Старейшинами, избранными из среди наиболее уважаемых торговцев и путешественников.

Холодная Крепость - крепость, расположенная на самой северной точке Замерзших Высот. Это стратегически важный пункт, контролирующий доступ к горным маршрутам и рудникам. Управляется военным советом, состоящим из ветеранов и горных воинов.

Забытый Аркан - город, скрытый в глубинах Искривлённых Лесов. Является местом сбора тайных культов, магов-одиночек и изгнанников. Управляется Советом Теней, состоящим из наиболее влиятельных и загадочных фигур города.

Вулканический Предел - небольшой, но важный город на Обсидиановых Полях. Он славится своими кузнецами и мастерами, обрабатывающими обсидиан и металлы, добываемые в вулканически активной зоне. Город управляется Гильдией Кузнецов.

## Торговля

В мире Даркхольма торговля является ключевым элементом, определяющим динамику и взаимодействия между различными регионами и культурами. Основные торговые маршруты, товары и методы транспортировки могут быть описаны следующим образом:

Маршрут из Укрепленных Городов через Искривлённые Леса: Этот маршрут используется для транспортировки ремесленных изделий, магических артефактов, и книг из городов в племена и кланы Искривленных Лесов. В обратном направлении идут травы, редкие растения и магические компоненты. Перевозка осуществляется караванами на повозках, сопровождаемыми наемными охранниками из-за опасности нападений.

Морской Путь от Портовых Городов к Укрепленным Городам: Суда перевозят рыбу, морепродукты, соль и загадочные артефакты, найденные в Море Тумана. В обратном направлении идут зерно, одежда и металлические изделия. Морской транспорт часто подвергается атакам пиратов и морских чудовищ.

Караваны через Пустынные Владения: Эти караваны перевозят ткани, специи, драгоценные камни и металлы. Из пустынь привозят экзотические материалы, такие как песчаный кристалл и обсидиан. Передвижение осуществляется на верблюдах и лошадях, с частыми остановками в караван-сараях.

Горные Караваны в Замерзших Высотах: Эти маршруты используются для транспортировки руды, драгоценных камней и уникальных горных трав. Опасность представляют снежные бури и горные чудовища. Транспортировка осуществляется на горных лошадях и мулах.

Воздушные Корабли из Обсерваторий и Магических Академий: Эти корабли перевозят книги, свитки, магические артефакты и инструменты. Они также используются для быстрой транспортировки ученых и магов между различными частями континента.

Торговля в Городах-Призраках: Хотя эти города кажутся заброшенными, они являются центрами торговли редкими и запретными товарами, такими как темная магия и запретные реликвии. Торговля здесь осуществляется скрытно и часто нелегально.

Эти торговые маршруты обеспечивают экономическую связь между различными регионами Даркхольма и создают множество возможностей для приключений, схваток и политических интриг для игроков.

## Политическое устройство

В мире Даркхольма политическое устройство отличается сложностью и многообразием, подчеркивая мрачную и мистическую атмосферу игры.
Политическая структура создает сложную сеть альянсов, конфликтов и интриг.

Фрагментированные Городские Государства: Каждый из укрепленных городов, расположенных на перекрестках торговых путей и в стратегически важных локациях, функционирует как независимое городское государство. У каждого есть своя форма правления, которая может варьироваться от магократии (власть магов) до теократии (власть духовенства) или олигархии (правление небольшой группы влиятельных лиц).

Кланы и Племена в Диких Землях: В более отдаленных и менее цивилизованных регионах, таких как Искривленные Леса или Пустынные Владения, господствуют племенные союзы и кланы. Они управляются по принципам кровного родства и личной храбрости, а их политические структуры часто основываются на традициях и обычаях.

Магические Ордена и Тайные Общества: В мире Даркхольма существуют многочисленные магические ордена, тайные общества и культы, которые влияют на политику с теневой стороны. Они могут контролировать отдельные территории или оказывать влияние на правители городов и племен.

Меркантильные Союзы и Гильдии: В портовых городах и крупных торговых центрах могут доминировать мощные торговые гильдии и меркантильные союзы. Эти организации зачастую обладают большой экономической мощью и способны влиять на политические решения.

Автономные Академии и Обсерватории: В Запредельных Реальностях и других местах, где исследуются магия и арканы, могут находиться автономные академии и обсерватории, управляемые мудрецами и учеными. Они часто стоят в стороне от политических интриг, но их знания и способности делают их важными игроками на политической арене.

Кочевые Общины и Караваны: В Пустынных Владениях и на Обсидиановых Полях кочевые общины и караваны могут функционировать как независимые политические единицы, управляемые старейшинами или советами.

## Население

В мире Даркхольма обитают различные народы, расы и виды существ, каждый из которых обладает своей уникальной культурой, историей и характеристиками. Это многообразие населения способствует созданию богатого и многогранного мира для исследования и взаимодействия.

### Люди

Наиболее многочисленные и разнообразные, люди обитают по всему Даркхольму. Они адаптируются к различным условиям и средам, от пустынь до ледяных пустошей, и создают сложные общества с разнообразными культурными и политическими структурами.

Внешний вид людей в Даркхольме разнообразен, в зависимости от их происхождения и региона проживания. От жителей северных гор до пустынных кочевников, их внешность отражает адаптацию к местным условиям – от светлой до темной кожи, разных цветов волос и глаз, различных телосложений.

### Эльфы Теневого Леса

Таинственные и уклончивые, эти эльфы обитают в Искривленных Лесах. Они обладают уникальными способностями к магии и знают много древних тайн. Их культура ценит гармонию с природой и мистические знания.

Эти эльфы имеют бледную, почти прозрачную кожу, длинные утонченные черты лица, большие выразительные глаза, часто темных или необычных оттенков. Их волосы могут быть как темными, так и светлыми, часто с прядями странных цветов. Они худощавы и грациозны.

Эльфы - мастера магических артефактов.

Ритуалы Эльфов Теневого Леса: Эти ритуалы часто связаны с природой, лунными циклами и древними магическими традициями. Они могут включать медитации, танцы, пение и жертвоприношения в честь древних лесных духов и божеств. Эти ритуалы направлены на гармонию с природой и её защиту.


### Дварфы Глубинных Гор

Народ, живущий в Замерзших Высотах и подземных пещерах. Они известны как великие кузнецы и ремесленники, создающие изделия из металла и камня непревзойденного качества.

Крепкого телосложения, с широкими плечами и мускулистыми руками, дварфы известны своей невысокой ростой. У них часто густые бороды и волосы, которые они носят в сложных прическах или заплетают. Их кожа обычно загорелая или смуглая от работы в кузнях.

Дварфы – экспертами в кузнечном деле.

Обряды Глубинных Дварфов: Дварфы проводят сложные ритуалы, связанные с кузнечным делом и горными богами. Они могут включать жертвоприношения драгоценных металлов и камней, а также обряды посвящения в кузнецах и шахтах.


### Туманные Призраки

Эфемерные существа, населяющие Море Тумана. Они кажутся неуловимыми и загадочными, и мало кто может сказать что-то конкретное о их истинной природе или целях.

Эти существа похожи на прозрачные, эфемерные фигуры, меняющие свою форму. Они могут казаться почти человеческими, но их контуры размыты, словно окутаны туманом.


### Пустынные Кочевники

Жители Пустынных Владений, приспособившиеся к суровым условиям. Они известны как отважные исследователи и торговцы, способные выживать в самых жестоких условиях.

Люди с загорелой кожей, защищенной от солнца светлыми одеждами. Их глаза часто прикрыты очками или тканями для защиты от песка, а волосы обычно короткие или убраны под головные уборы.

Пустынные кочевники часто формируют союзы для общей защиты своих караванных путей.
Пустынные кочевники могут испытывать нехватку воды и пищевых продуктов.

Празднования Пустынных Кочевников: В культуре кочевников большое значение имеют праздники, связанные с звёздами и водой. Эти празднования могут включать ночные танцы, рассказы и обряды благодарения за дождь и плодородие.

### Горные Отшельники

Разрозненные группы, проживающие в Замерзших Высотах. Они часто уединены и суровы, но обладают глубокими знаниями о горах и их тайнах.

Люди с крепким телосложением, часто с шершавой кожей и грубыми чертами лица. Они носят практичную, теплую одежду, обычно из шкур и толстой ткани.

Обитатели горных регионов могут страдать от нехватки древесины и сельскохозяйственных продуктов.

### Нимфы и Дриады

Существа, связанные с природой, обитающие в Искривленных Лесах. Они защищают свои дома от внешних угроз и редко вступают в контакт с другими расами.

Существа с внешностью, напоминающей деревья или растения, с кожей, похожей на кору, и волосами, напоминающими листву или цветы. Их глаза могут светиться зеленым или золотистым цветом.


### Обитатели Обсидиановых Полей

Народ, приспособившийся к жизни в экстремальных условиях вулканической активности. Они известны как мастера обработки обсидиана и других вулканических материалов.

Имеют прочную, часто загорелую кожу, волосы и бороды защищены от искр и пепла. Они носят прочную, но удобную одежду, украшенную металлическими и обсидиановыми элементами.

### Таинственные Жители Запредельных Реальностей

Существа неизвестного происхождения, живущие в областях, где границы между мирами размываются. Их натура и мотивы окутаны тайной.

Их внешний вид варьируется от совершенно человеческого до странных, почти абстрактных форм. Они могут иметь необычные цвета кожи, глаз, и другие экзотические особенности.

### Зверолюди и Монстры

Различные виды нечеловеческих существ, населяющих мир. Они варьируются от относительно мирных племен до опасных и враждебных монстров, обитающих в самых темных уголках Даркхольма.

Эти существа могут быть смесью человеческих и животных черт, с разнообразием форм и размеров, от волчьих голов до змеиных хвостов, чешуи, когтей, перьев и других элементов.

## Языки

В Даркхольме нет единого языка, используемого всеми народами. Разные расы и культуры имеют свои языки и диалекты. Например, эльфы Теневого Леса могут говорить на древнем эльфийском, в то время как дварфы используют свой собственный горный диалект.
В крупных торговых и политических центрах, таких как Тенебург или Морской Вал, часто используется общий торговый язык, который позволяет общаться представителям разных народов.

## Взаимоотношения межу расами

Взаимоотношения между разными расами и культурами варьируются от дружественных до враждебных. Например, горные отшельники могут поддерживать торговые отношения с дварфами, в то время как эльфы Теневого Леса могут избегать контактов с внешним миром.
Некоторые расы, как правило, более склонны к изоляции и самодостаточности, в то время как другие активно участвуют в межрасовой торговле и политических союзах.

### Люди и Эльфы Теневого Леса:

Часто напряженные отношения из-за различий в ценностях и культуре.
Эльфы оберегают свои леса и редко доверяют людям, которых считают разрушителями природы.
Некоторые группы людей и эльфов могут сотрудничать в торговле или магии, но такие союзы скорее исключение, чем правило.

### Люди и Дварфы Глубинных Гор:

В целом дружественные отношения, основанные на торговле и обмене ресурсами.
Дварфы ценят человеческие изделия и продукты, в то время как людям нужны дварфийские ремесла и металлы.
Общая угроза от внешних врагов часто сплачивает эти расы.

### Эльфы и Дварфы:

Исторически сложные отношения, часто характеризующиеся недоверием и конкуренцией.
Вражда может быть обусловлена различиями в отношении к природе и использованию ее ресурсов.
Временные союзы возможны против общих врагов, но они редки и неустойчивы.

### Пустынные Кочевники и Портовые Города:

В основном дружественные и взаимовыгодные отношения.
Кочевники часто торгуют с портовыми городами, предлагая продукты пустыни в обмен на морские товары.
Обе стороны зависят друг от друга для поддержания торговли.

### Горные Отшельники и Другие Расы:

Горные отшельники, как правило, изолированы и предпочитают избегать контактов с другими расами.
В случае необходимости, они могут вступать в контакт с людьми или дварфами, но такие взаимодействия ограничены и основаны на практических потребностях.

### Нимфы, Дриады и Люди:

Отношения напряженные, особенно когда речь идет о вторжении в их природные территории.
Нимфы и дриады могут быть враждебными к любым, кто угрожает их домам, но иногда могут помогать тем, кто уважает природу.

### Обитатели Обсидиановых Полей и Пустынные Кочевники:

Взаимоотношения обусловлены торговлей, особенно в области обмена минералами и камнями на продукты и воду.
В целом, отношения нейтральные, сосредоточенные на коммерции и обмене.

### Таинственные Жители Запредельных Реальностей и Остальные Расы:

Отношения загадочны и малоизучены, поскольку эти существа редко вступают в контакт с внешним миром.
Их появление часто считается знамением или предвещанием необычных событий.

### Зверолюди и Монстры:

Отношения между этими существами и другими расами варьируются от враждебных до неустойчивых союзов.
Некоторые зверолюди могут вести мирный образ жизни, в то время как другие виды монстров являются опасностью для всех.

## История мира

В мире Даркхольма, где древние боги неизменно олицетворяли нечто угрожающее и непостижимое, история никогда не знала эры мирного процветания. Вместо этого, этот мир всегда был местом, где тяжелая завеса кошмаров и неизведанных тайн скрывала его истинную сущность.

### Древний Период
В самом начале, Даркхольм был землей, полной первозданной, дикарской красоты, где природа и элементы царили безраздельно. Могущественные существа, которые можно было назвать богами, бродили по этому миру, оставляя следы своего присутствия в форме монолитов и непостижимых руин. Эти существа, хоть и не всегда враждебные, были далеки от понятий добра и зла, следуя своим непостижимым целям и желаниям.

### Эпоха Туманов
Со временем, появились первые цивилизации. Они воспринимали богов как часть своей суровой реальности, поклоняясь им и боясь одновременно. Эти древние народы строили города и создавали сложные ритуалы, пытаясь умилостивить или узнать тайны своих божественных хозяев. Но даже в эти времена, мир оставался местом тьмы и загадок, полным опасностей и неведомых угроз.

### Падение Цивилизаций
Неизвестные катастрофы, вызванные, возможно, гневом богов или их необъяснимыми действиями, привели к падению этих ранних цивилизаций. Города рухнули, знания были утеряны, и люди вернулись к более примитивному образу жизни. Руины древних городов и храмов стали молчаливыми свидетелями былой славы и мощи.

### Современная Эра
В наши дни, мир Даркхольма – это место, где новые цивилизации построили свои города на развалинах старых. Легенды о древних богах и их загадочных делах передаются из поколения в поколение. Но теперь, люди стали более осторожными и изобретательными, научившись выживать и процветать в этом мрачном и непредсказуемом мире, несмотря на все его угрозы и тайны.

История мира Даркхольма омрачена рядом крупных военных конфликтов, каждый из которых оставил свой след в истории и культуре его народов. Эти конфликты были вызваны различными причинами, включая борьбу за ресурсы, религиозные и культурные разногласия, а также вмешательство древних и могущественных сил.

#### Война Теневых Эльфов
Древний конфликт между эльфами Теневого Леса и людьми, возникший из-за расширения человеческих поселений на территории лесов. Эта война характеризовалась засадами, гильдийными убийствами и магическими дуэлями. Она привела к длительному недоверию между этими расами и установлению строгих границ лесных территорий.

#### Восстание Глубинных Дварфов
Серия восстаний, произошедших в горных королевствах дварфов, вызванных жестоким управлением и эксплуатацией дварфийского народа. Этот конфликт привел к кровопролитным битвам в подземельях и на горных перевалах, а также к падению нескольких дварфийских династий.

#### Пустынная Война
Долгий и изнурительный конфликт между пустынными кочевниками и соседними государствами за контроль над пустынными торговыми путями и водными источниками. Эта война характеризовалась затяжными осадами и героическими караван-битвами.

#### Шторм Моря Тумана
Серия морских сражений между портовыми городами и пиратскими флотилиями, борющимися за контроль над торговыми путями Моря Тумана. Эти сражения были известны своей жестокостью и использованием магии в морских боях.

#### Вторжение Теневых Сущностей
Мистический и катастрофический конфликт, когда из Запредельных Реальностей в мир прорвались неизвестные теневые сущности. Этот конфликт объединил многие расы и народы Даркхольма в борьбе против общего врага и привел к невообразимым разрушениям и потерям.

#### Восстание Зверолюдей
Масштабное восстание зверолюдей против угнетения и эксплуатации со стороны других рас. Этот конфликт был полон зверства и жестокости, приведя к переоценке отношений между различными видами существ в Даркхольме.


## Магия

В мире Даркхольма, где вся магия имеет темный и часто опасный характер, обитатели приспособились использовать её с осторожностью и уважением, осознавая её потенциальную опасность.

### Использование Магии в Повседневной Жизни:

Магия в Даркхольме используется осторожно и обдуманно. Она может применяться в ремесле, например, для улучшения качества металлов или создания уникальных предметов. В медицине магия может помогать в лечении, хотя часто сопряжена с побочными эффектами или рисками.

Путешествия часто осуществляются традиционными способами, такими как пешее перемещение, верховые животные или плавание. Однако, в некоторых случаях магия используется для ускорения передвижения или преодоления препятствий. Например, магические порталы могут соединять ключевые точки мира, но их использование рискованно и часто охраняется.

В больших городах и ученых обществах магия может использоваться для передачи сообщений на расстоянии, например, через магические зеркала или кристаллы. Однако, такие методы доступны не всем из-за их сложности и потенциальных рисков.

Использование магии в развлекательных целях возможно, но это скорее исключение. Шоу с использованием магии могут включать демонстрацию иллюзий или магических трюков, однако такие представления требуют высокой квалификации и осторожности из-за опасного характера магии.

Правительства и правящие классы часто используют магию для поддержания и укрепления своей власти. Это может включать магическую защиту важных зданий, использование магии для сбора информации или подавления восстаний.
В некоторых государствах власть может принадлежать магам или магическим орденам, которые используют свои способности для управления и контроля.

### Опасности магии

Магия несет в себе глубокий и неоднозначный характер. Она окутана аурой опасности и страха, приоткрывая двери к неизведанным и часто ужасающим реальностям.

Физические Риски: Применение магии требует колоссальных физических усилий и концентрации. Неправильное использование или потеря контроля может привести к физическому истощению, травмам или даже смерти. Сложные заклинания могут оставить мага истощенным или навсегда изуродованным.

Психические Последствия: Изучение и использование магии часто сопровождается психическими рисками. Маги могут испытывать галлюцинации, потерю рассудка, навязчивые мысли или стать жертвами паранойи. Длительное погружение в магию может привести к необратимому умственному расстройству.

Демонические и Потусторонние Сущности: Магия в Даркхольме часто связана с призывом или общением с потусторонними сущностями. Эти сущности могут оказаться коварными, обманчивыми или враждебными, ставя под угрозу не только мага, но и окружающих его людей.

Проклятия и Заклятья: Многие магические практики включают использование проклятий или заклятий, которые могут иметь непредвиденные и часто катастрофические последствия. Проклятие может обернуться против того, кто его наложил, или распространиться дальше предполагаемой цели.

Запретная и Древняя Магия: Использование запретной или древней магии особенно опасно. Эти виды магии часто связаны с древними ритуалами и забытыми языками, открывая пути к могущественным, но непостижимым силам. Их применение может привести к необратимым изменениям в реальности, порождая ужасы, которые невозможно контролировать или понять.

Магическое Загрязнение: Интенсивное использование магии может привести к магическому загрязнению - искажению окружающей среды или даже самой ткани реальности. Это может проявляться в виде странных аномалий, непредсказуемых погодных условий или появления чудовищных существ.


## Технологии

### Мультиплеер

#### Требования

Технически игра должна суметь обслуживать столько же одновременно подключенных игроков, сколько было на пике у Eve Online, то есть 65 303.

Нужно сразу готовиться к масштабированию игры путем увеличения количества серверов ее обслуживающих.
Все должно быть устроено таким образом что на каждом сервере можно было обслуживать тысячи игроков.

В мморпг прокачка и урон должны происходить на сервере, а на клиенте должен только показываться интерфейс.

#### Представление состояния мира

Для хранения и передачи по сети состояний всего что может менять состояние в игре используется специальная структура данных:

Есть большой массив со всеми персонажами и активными монстрами, размер его заранее выбирается достаточно большим, чтобы не требовалось реаллокаций. В каждой ячейке кроме позиции и параметров персонажа хранится уникальный идентификатор персонажа, получаемый путем инкремента 64-битного счетчика при каждом создании нового персонажа. На персонажей таким образом можно хранить указатели, которые всегда указывают на валидную память в которой лежит либо тот самый персонаж на которого указатель указывал изначально, либо какой-то другой, который поместили в ту же ячейку после смерти старого. 

Для валидации указателей вместе с ними нужно хранить значение уникального идентификатора, если оно совпадает, персонаж точно тот самый, а если не совпадает - указатель протух. Для передачи по сети для каждого клиента заводится исходящий буфер, очередь отправки и массив битиков обозначающих присутствие в очереди соответствующего персонажа. Очередь организуется как циклический буфер достаточного размера чтобы туда уместились указатели на всех персонажей.

При изменении состояния персонажа, для каждого клиента проделываются следующие действия: в массиве битиков выставляется (если еще не была выставлена) единичка для этого персонажа. Если до этого там был нолик, то указатель на этого персонажа добавляется в очередь на отправку. Раз в кадр, если в буфере клиента есть свободное место, буфер заполняется данными о состоянии персонажей в порядке появления в очереди на отправку, и содержимое буфера отправляется по сети клиенту.

Таким образом при быстром изменении состояния одного персонажа, клиент с медленной сетью получает не последовательность состояний, а только одно свежее состояние.

В ходе работы не происходит ни одной аллокации или деаллокации, память не фрагментируется, обход памяти происходит в основном последовательно. Дальнейшие оптимизации: не ставить в очередь на отправку далекие и невидимые клиенту персонажи, не передавать мгновенные координаты, а использовать координаты начала и конца и моментах начала и конца движения, так что состояние начавшего двигаться из точки А в точку Б персонажа достаточно передать 1 раз, после чего персонаж на сервере и у всех клиентов будет двигаться синхронно до точки Б, где он и остановится.

Часто кликающих туда-сюда игроков и ИИ можно затроттлить, чтобы персонажи не меняли текущее действие чаще чем 4 раза в секунду.

#### Лаг-компенсация на клиенте

Игрок кликает мышкой. Клиент игрока рисует визуальный отклик, чтобы игрок понимал, что его клик воспринят игрой. На сервер отправляется команда «иди туда». Сервер получает команду, например через 25 мс, и  применяет ее к персонажу игрока. В плане действий персонажа появляется новое состояние «персонаж в следующий кадр физики начнёт движение из той точки где он будет в следующий кадр физики в ту точку которую указал игрок». Следующий физический кадр отстоит от этого момента на 50 мс в будущее, то есть физика квантована по 20 кадров в секунду и считается вперёд на 1 кадр в будущее. Теперь у сервера есть данные о действиях игрока на 50 мс вперёд, сервер записывает последнее действие в состояние персонажа и оно синхронизируется по сети. Все игроки с хорошей сетью получают это состояние. У них 50 мс на то, чтобы успеть получить данные и нарисовать идеальную картинку. Клиент не обязан выкидывать предыдущие состояния персонажа, полученные по сети, клиенту не нужно быть высокоэффективным, поэтому клиент может хранить 2 последних состояния и использовать их для показа идеального мультика о движении персонажа.

Если же у клиента большой пинг, состояние дойдёт к нему поздно, скажем на 150 мс позже чем хотелось бы, за это время персонаж на клиенте может оказаться далеко от исходной точки движения описанной новым состоянием и ещё дальше от той точки в которой он должен быть к этому моменту при движении по заданной траектории. Тут начинает применяться клиентская компенсация лага. Персонаж начинает движение из той точки где он визуально находится и движется в ту точку где он должен был бы оказаться, но делает это быстрее чем должен по физике, чтобы за время порядка 250 мс оказаться в идеальной позиции и продолжить движение показывая идеальную картинку.


#### Основные технические характеристики 

Игровой мир будет бесшовным, размер карты 8 км х 8 км, в мире будет всего 262144 персонажей, из которых половина может управляться игроками, а вторая половина - ИИ.

Мир разделяется на шарды по географическому принципу, при этом динамически меняя границы раздела для того, чтобы особо крупные скопления игроков не перегружали отдельные локации.

